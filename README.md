# Сверка платежей из двух XLSX

Скрипт `compare_payments.py` сравнивает суммы платежей клиентов из двух Excel-файлов по персональному номеру и формирует итоговый отчет.

## Что делает скрипт

- Считывает 2 входных файла (`--file1`, `--file2`).
- Сопоставляет компании по персональному номеру.
- Сравнивает суммы платежей.
- Учитывает компании, которые есть только в одном файле.
- Формирует итоговый отчет `xlsx` с листами:
  - `comparison` - детальная сверка.
  - `summary` - сводка по статусам.

## Формат итогового отчета

- Статусы:
  - `MATCH`
  - `MISMATCH`
  - `only_file_<имя_файла>`
- Цвета строк:
  - `MATCH` - светло-зеленый
  - остальные статусы - светло-красный
- Денежные столбцы `D:E:F`:
  - формат `#,##0.00`
- Данные отсортированы по столбцу `A` (по возрастанию).
- Заголовки всегда в первой строке.
- Для листов включен автофильтр.
- Ширина столбцов подстраивается по содержимому.

## Требования

- Python 3.10+
- Зависимости из `requirements.txt`

Установка вручную:

```powershell
pip install -r requirements.txt
```

## Быстрый запуск

Запуск с параметрами по умолчанию:

```powershell
python compare_payments.py
```

Запуск с явными путями:

```powershell
python compare_payments.py --file1 work/OC.xlsx --file2 work/1C.xlsx --out reports/payments_comparison.xlsx
```

## Графический интерфейс (GUI)

Можно запустить простое окно выбора файлов:

```powershell
python compare_payments.py --gui
```

В окне:
- выберите отчет ОС,
- выберите отчет 1С,
- выберите куда сохранить файл сверки банка,
- нажмите `Сформировать отчет`.

## Подготовка окружения одной командой

Для автоматической подготовки окружения используйте:

```powershell
powershell -ExecutionPolicy Bypass -File .\setup.ps1
```

Скрипт:
- создает `.venv` (если его нет),
- обновляет `pip`,
- ставит зависимости из `requirements.txt`.

Если при запуске лаунчера видите:
`[ERROR] .venv is not found.`
выполните команду подготовки выше и затем снова запустите `Сверка банка.bat`.

Подробная инструкция по переносу проекта через флешку и запуску на новом ПК: `README_PORTABLE.md`.
